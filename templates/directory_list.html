{% extends "base.html" %}

{% block body %}

<ol class="breadcrumb">
  <li>运维管理</li>
  <li class="active">文件服务器</li>
</ol>

<div class="page-header">
    <h2>
        文件服务器
    </h2>
</div>

<table class="table table-hover">
    <caption>
      <form class="form-inline" style="float: right;" action="/filemanager/directory_list" method="post">
       {% csrf_token %}
        <div class="form-group">
          <p class="form-control-static">
              <select class="form-control" name="filter_select">
                <option>名称</option>
                <option>大小</option>
                <option>修改时间</option>
              </select>
          </p>
          <input type="text" class="form-control" name="filter_keyword" value="{{filter_keyword}}" placeholder="">
          <input type="hidden" class="form-control" name="dist" value="{{current_directory}}" placeholder="">
        </div>
        <button type="submit" class="btn btn-default"><span class="fa fa-filter"></span> 过滤</button>
        <div class="btn-group">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          更多操作 <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right">
          <li><a href="#">下载</a></li>
          <li role="separator" class="divider"></li>
          <li><a href="#">其他</a></li>
        </ul>
      </div>
      </form>
    </caption>
    <tr>
        <td colspan="12" data-column="0">
            <span class="table_count">显示 {{ file_list_count }} 项目<code style="font-size: 13px;">Path: {{path}}</span>
        </td>
    </tr>
    <tr class="active">
        <th><input type="checkbox" name="check_all" id="check_all" onclick="checkAll()"></th>
        <th width="40%">名称</th>
        <th width="20%">大小</thw>
        <th width="25%">修改时间</th>
        <th colspan="4" width="15%">操作</th>
    </tr>
    {% for file_info in file_list %}
    {% if file_info.is_directory == 1  %}
    <tr>
        <td><input type="checkbox" name="check_item"></td>
        <td>
        <span class="fa fa-folder-o">
            {% if file_info.file_name != '..' %}
            <a style="color:inherit;" href="?host={{host}}&path={{path}}/{{file_info.file_name}}">
            {% endif %}
            {% if file_info.file_name == '..' %}
            <a style="color:inherit;" href="?host={{host}}&path={{parent_path}}">
            {% endif %}
            {{file_info.file_name}}
            </a>
        </span>
        </td>
        <td>{{file_info.file_size}}</td>
        <td>{{file_info.file_mtime}}</td>
        <td>

          <!-- Split button -->
          {% if file_info.file_name != '..' %}
          <div class="btn-group">
            <a type="button" class="btn btn-default btn-sm" href="?host={{host}}&path={{path}}/{{file_info.file_name}}">打开</a>
            <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right">
              <li><a href="">下载</a></li>
            </ul>
          </div>
          {% endif %}
          {% if file_info.file_name == '..' %}
          <div class="btn-group">
            <a type="button" class="btn btn-default btn-sm" href="?host={{host}}&path={{parent_path}}">打开</a>
            <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right">
              <li><a href="">下载</a></li>
            </ul>
          </div>
          {% endif %}        
        </td>
    </tr>
    {% endif %}
    {% endfor %}

    {% for file_info in file_list %}
    {% if file_info.is_directory == 0  %}
    <tr>
        <td><input type="checkbox" name="check_item"></td>
        <td>
        <span class="fa fa-file-text-o">
            <a a style="color:inherit;" href="/filemanager/text_viewer?host={{host}}&path={{path}}/{{file_info.file_name}}">
            {{file_info.file_name}}
            </a>
        </span>
        </td>
        <td>{{file_info.file_size}}</td>
        <td>{{file_info.file_mtime}}</td>
        <td>

        <!-- Split button -->
          <div class="btn-group">
            <a type="button" class="btn btn-default btn-sm" href="/filemanager/text_viewer?host={{host}}&path={{path}}/{{file_info.file_name}}">查看 &nbsp;&nbsp;</a>
            <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right">
              <li><a href="/filemanager/file_download?host={{host}}&path={{path}}/{{file_info.file_name}}">下载</a></li>
            </ul>
          </div>
        </td>
    </tr>
    {% endif %}
    {% endfor %}
    <tr>
        <td colspan="12" data-column="0">
            <span class="table_count">显示 {{ file_list_count }} 项目</span>
        </td>
    </tr>
</table>

{% endblock %}